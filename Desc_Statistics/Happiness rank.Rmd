---
title: "Happiness rank and scores by country, 2019"
output:
  html_document:
    fig_caption: false
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(digits = 7)

library(tidyverse)
library(Hmisc)
library(corrplot)
library(rio)
library(tinytex)
library(ggplot2)
library(dplyr)
library(MASS)
library(knitr)


```


```{r echo=FALSE, include=FALSE}
happiness <- read_csv ("data/2019.csv")
```


## Correlation Matrix

```{r echo=FALSE,  include=FALSE}
happiness_cm <-happiness[,c(4:9)]
happiness.cor = cor(happiness_cm)
#compute Spearman  coefficients

happiness.cor = cor(happiness_cm, method = c("spearman"))

happiness.rcorr = rcorr(as.matrix(happiness_cm))
happiness.rcorr

happiness.coeff = happiness.rcorr$r
happiness.p = happiness.rcorr$P



```

```{r echo=FALSE}
#Visualizing the correlation matrix
corrplot(happiness.cor)
```



## Pie chart:

```{r echo=FALSE}
mu_1 <- mean(happiness$`GDP per capita`)
mu_2 <-mean(happiness$`Social support`)
mu_3 <- mean(happiness$`Healthy life expectancy`)
mu_4 <- mean(happiness$`Freedom to make life choices`)
mu_5 <- mean(happiness$`Generosity`)


sd_1   <- sd(happiness$`GDP per capita`)
sd_2 <- sd(happiness$`Social support`)

x <-  c(mu_1, mu_2, mu_3,mu_4 , mu_5)

labels <-  c("GDP per capita","Social support","Healthy life expectancy","Freedom to make life choices","Generosity")

piepercent<- round(x, 1)

# Plot the chart.
pie(x, labels = piepercent, main = "Precentage Pie chart",col = rainbow(length(x)))
legend("topright", c("GDP per capita","Social support","Healthy life eâ€¦","Freedom to make life choices","Generosity"), cex = 0.5,
       fill = rainbow(length(x)))

```

## The Standard Normal Distribution:


```{r echo=FALSE}
ggplot(happiness) + 
  geom_function(aes(color = "GDP per capita"), fun = dnorm, args = list(mean = mu_1, sd = sd_1)) +
  geom_function(aes(color = "Social support"), fun = dnorm, args = list(mean = mu_2, sd = sd_2)) +
 
   labs(title = "Normal Distrbution for GDP per capita(economy) and Social support ",
       x = "GDP per capita(economy) and Social support",
       y = "frequncy") +
 
   theme_classic() 
```


## Describe Social support

```{r echo=FALSE}

des <- describe(happiness$`Social support`)

des 
     

```


### Digram fo show ** Normal Distrubution ** with the curv..

```{r echo=FALSE}

ggplot(happiness, aes(`Social support`)) +
  geom_density() +
  stat_function(fun = dnorm, args = list(mean = mu_2,sd = sd_2),col="pink", )



```


## Test Normal Distribution by using **shapiro.test**:


```{r echo=FALSE}
SS <- happiness$`Social support`

SSN <- c(SS, mu_2, sd_2)

Nt =shapiro.test(SSN)

Nt
```

## Confidence Intervals:

### - Social support
```{r echo=FALSE}
##### Confidence Intervals ####
## The upper bound of the confidence interval
SE_SS <- sd(happiness$`Social support`, na.rm = T)/sqrt(length(happiness$`Social support`) - sum(is.na(happiness$`Social support`)))


CI_upper_2 <- mu_2 + 1.96* SE_SS
## The Lower bound of the confidence interval

CI_lower_2 <- mu_2 - 1.96* SE_SS


CI_upper_2
CI_lower_2
```

### - GDP per capita (Econmy)

```{r echo=FALSE}
##### Confidence Intervals ####
## The upper bound of the confidence interval
SE_Econmy <- sd(happiness$`GDP per capita`, na.rm = T)/sqrt(length(happiness$`GDP per capita`) - sum(is.na(happiness$`GDP per capita`)))

CI_upper_1 <- mu_1 + 1.96* SE_Econmy
## The Lower bound of the confidence interval

CI_lower_1 <- mu_1 - 1.96* SE_Econmy


CI_upper_1
CI_lower_1
```

## T-testing:
### - Social support

```{r echo=FALSE}

t.test(happiness$`Social support`) 
```

### - GDP per capita (Econmy)

```{r echo=FALSE}

t.test(happiness$`GDP per capita`) 
```


## Hypothesis testing:

95% CI in action.

- 95% confidence interval for the Social support  is [1.161863, 1.255765].


```{r echo=FALSE}
 HTSS_mean <- sum(CI_upper_2,CI_lower_2)/2 # i.e. just take the mean

HTSS_SEM <- (CI_upper_2 - HTSS_mean)/CI_lower_2

HTSS_SEM <- sd_2 / sqrt(length(happiness$`Social support`))
                        

HTSS_SEM





```




- 95% confidence interval for the GDP per capita (Econmy) is [0.9676649, 0.8426299].


```{r echo=FALSE}
#### Standard Errors ####

SE_Econmy <- sd(happiness$`GDP per capita`, na.rm = T)/sqrt(length(happiness$`GDP per capita`) - sum(is.na(happiness$`GDP per capita`)))


SE_Econmy

```

